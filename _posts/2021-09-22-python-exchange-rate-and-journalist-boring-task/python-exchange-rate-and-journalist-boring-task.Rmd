---
title: "Python, exchange rate and journalist boring task"
description: |
  Journalists can use Python not only for data journalism, but also for automating mundane repetitive tasks such as converting currencies
date: 2021-09-22
categories:
  - Python
  - The-Jakarta-Post
preview: images/convert_usdidr_py.png
output:
  distill::distill_article:
    highlight: pygments
    highlight_downlit: false
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = FALSE)
library(reticulate)
```

I’ve been using Python to automate one small boring task that I do nearly everyday: converting a figure in the Indonesian rupiah to the United States (US) dollar or vice versa.

This practice follows The Jakarta Post’s writing guideline that requires journalists to add the US dollar equivalent whenever we add a figure in rupiah. This is helpful especially for foreign readers. 

The Post’s style for US dollars is “US${figure}” and rupiah “Rp {figure}.” (I know, putting a space between the rupiah’s symbol and the figure is not the correct way of writing it. That also bothered me at first.)

This forces me to go back and forth between my calculator, Google Docs and the website that publishes the exchange rate, such as Yahoo Finance, Reuters, Bloomberg or Bank Indonesia (BI). And then I will have to get the result in the correct format according to the Post’s style.

So I wrote a simple Python script to make life slightly easier. 

I use the **yfinance** library to get the latest exchange rate data from [Yahoo Finance](https://finance.yahoo.com/quote/usdidr=X?ltr=1){target=“_blank”}. We just need to download the data with the `download()` function and pass the “USDIDR=X” as the ticker. Then we set the period to just one day by passing “1d” to the `period` parameter to keep things simple and allow faster load time.

```{python}
from sys import exit
from yfinance import download
import pyperclip

print("Getting the latest exchange rate from Yahoo Finance...")

usd_idr_raw = download(tickers = "USDIDR=X", period = "1d", progress = False)

exchange_rate = usd_idr_raw.Close[0]

print(f"Latest USD-IDR exchange rate: Rp{exchange_rate:,}")
```

(I set `progress` to `False` to turn off the progress bar in the console.)

We will take input from users to tell us the base currency. To handle errors, we can add a condition and a suggestion that tells users what currencies the program can accept. Then, we take another input for the base figure.

```{python}
print("Choose the base currency:\n1. IDR\n2. USD")
base_currency = input("> ").upper()

accepted_currency = ["IDR", "USD"]

if not base_currency in accepted_currency:
    print("The currency input is not recognized.")
    print(f"Choose one of the following: {', '.join(accepted_currency)}")
    exit(1)

print("Please write the base figure:")
currency_input = float(input("> "))
```

Now, we can start converting the base figure, rounding it and writing it in a format that is easier to read. We will store the symbol of the currency output that we will use later. We also need to convert the long figures into units like million, billion, etc.

```{python}
# The currency symbol is the opposite of the currency input
if base_currency == "IDR":
    result_raw = currency_input / exchange_rate
    currency_symbol = "US$"
else:
    result_raw = currency_input * exchange_rate
    currency_symbol = "Rp "

result_whole = round(result_raw)

len_result = len(str(result_whole))

if result_whole > 1000000:
    denominator = int("1" + "0" * (len_result - 1))
    result_converted = round(result_raw / denominator, 2)

if len_result < 7:
    unit = ""
elif len_result >= 7:
    unit = "million"
elif len_result >= 10:
    unit = "billion"
elif len_result >= 13:
    unit = "trillion"
elif len_result >= 16:
    unit = "quadrillion"
else:
    print("Please provide the unit:")
    unit = input("> ")

if result_whole > 1000000:
    result_print = result_converted
else:
    result_print = round(result_raw, 2)
```

Finally, we can combine the result, currency symbol and unit in line with the Post’s style for the final result and printing to the console. To facilitate users further, we can copy the result to clipboard using the **pyperclip** library.

```{python}
result_formatted = f"{currency_symbol}{result_print:,} {unit}"

print(f"Result: {result_formatted}")

pyperclip.copy(result_formatted)

print("The result has been copied to clipboard!")
```

The product is a very simple yet helpful program. It allows users to convert rupiah figures to US dollars or the other way around all in the command line.

```{r eval=TRUE, echo=FALSE}
knitr::include_graphics("images/convert_usdidr.gif")
```

Python (or R) is common for doing data journalism, which involves working with a large amount of data. I myself use R as my go-to tool for working on [data stories](https://github.com/dzulfiqarfr/jakpost-chart-data){target="_blank"}.

But programming can also give us journalists a small win, such as improving the workflow for converting currencies.

<p style="color:#999">*Last updated: `r format(Sys.Date(), "%b. %d, %Y")`*</p>